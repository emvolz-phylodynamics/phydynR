<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate a coalescent genealogy based on a demographic process. — sim.co.tree • phydynR</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate a coalescent genealogy based on a demographic process. — sim.co.tree"><meta name="description" content="A tree is simulated based on a demographic process and user-supplied parameters
  and initial conditions. The times and types of samples must also be supplied."><meta property="og:description" content="A tree is simulated based on a demographic process and user-supplied parameters
  and initial conditions. The times and types of samples must also be supplied."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phydynR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/phydynR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/sir_model.html">Estimating transmission rate using the SIR model</a></li>
    <li><a class="dropdown-item" href="../articles/HIV_epidemics.html">Estimating HIV transmission rates</a></li>
    <li><a class="dropdown-item" href="../articles/simulate_genealogies.html">Simulating genealogies with an epidemiological coalescent model</a></li>
    <li><a class="dropdown-item" href="../articles/SenegalHIVmodel.html">HIV Senegal Model</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emvolz-phylodynamics/phydynR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate a coalescent genealogy based on a demographic process.</h1>
      <small class="dont-index">Source: <a href="https://github.com/emvolz-phylodynamics/phydynR/blob/HEAD/R/treeSimulatorCpp2.R" class="external-link"><code>R/treeSimulatorCpp2.R</code></a></small>
      <div class="d-none name"><code>sim.co.tree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A tree is simulated based on a demographic process and user-supplied parameters
  and initial conditions. The times and types of samples must also be supplied.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim.co.tree</span><span class="op">(</span></span>
<span>  <span class="va">theta</span>,</span>
<span>  <span class="va">demographic.process.model</span>,</span>
<span>  <span class="va">x0</span>,</span>
<span>  <span class="va">t0</span>,</span>
<span>  <span class="va">sampleTimes</span>,</span>
<span>  sampleStates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  integrationMethod <span class="op">=</span> <span class="st">"lsoda"</span>,</span>
<span>  finiteSizeCorrections <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  substitutionRates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sequenceLength <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>A named vector of parameter values required by the model</p></dd>


<dt id="arg-demographic-process-model">demographic.process.model<a class="anchor" aria-label="anchor" href="#arg-demographic-process-model"></a></dt>
<dd><p>An object of class demographic.process.
See <code><a href="build.demographic.process.html">build.demographic.process</a></code></p></dd>


<dt id="arg-x-">x0<a class="anchor" aria-label="anchor" href="#arg-x-"></a></dt>
<dd><p>A named vector of initial conditions required by the model. This
includes demes and any other dynamic variables.</p></dd>


<dt id="arg-t-">t0<a class="anchor" aria-label="anchor" href="#arg-t-"></a></dt>
<dd><p>The time of origin of the process</p></dd>


<dt id="arg-sampletimes">sampleTimes<a class="anchor" aria-label="anchor" href="#arg-sampletimes"></a></dt>
<dd><p>A numeric vector providing the times of samples. If named,
taxon labels will be based on names of the corresponding sample times</p></dd>


<dt id="arg-samplestates">sampleStates<a class="anchor" aria-label="anchor" href="#arg-samplestates"></a></dt>
<dd><p>For models with more than one deme, a matrix must be
supplied describing the probability of sampling from each deme. Each row
corresponds to a sample in the same order as sampleTimes. Each column
corresponds to probability of sampling each deme. Column names should be
defined which correspond to deme names in the model. Rows should sum to one.</p></dd>


<dt id="arg-res">res<a class="anchor" aria-label="anchor" href="#arg-res"></a></dt>
<dd><p>Integer number of time steps to use when simulating model.</p></dd>


<dt id="arg-integrationmethod">integrationMethod<a class="anchor" aria-label="anchor" href="#arg-integrationmethod"></a></dt>
<dd><p>If simulating an ODE (ordinary differential equation)
model, this provides the integration routine corresponding to options in
deSolve.</p></dd>


<dt id="arg-finitesizecorrections">finiteSizeCorrections<a class="anchor" aria-label="anchor" href="#arg-finitesizecorrections"></a></dt>
<dd><p>to do</p></dd>


<dt id="arg-substitutionrates">substitutionRates<a class="anchor" aria-label="anchor" href="#arg-substitutionrates"></a></dt>
<dd><p>to do</p></dd>


<dt id="arg-sequencelength">sequenceLength<a class="anchor" aria-label="anchor" href="#arg-sequencelength"></a></dt>
<dd><p>to do</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class DatedTree, which subclasses ape::phylo.
 The $heights attribute provides the time of each node in the tree.
 The $maxHeight attribute provides the time of the root.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Erik Volz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A simple exponential growth model with birth rates beta, and death rates gamma: </span></span></span>
<span class="r-in"><span><span class="co"># I is the number of infected individuals</span></span></span>
<span class="r-in"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="build.demographic.process.html">build.demographic.process</a></span><span class="op">(</span>births <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>I <span class="op">=</span> <span class="st">'parms$beta * I'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               deaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>I <span class="op">=</span> <span class="st">'parms$gamma * I'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               parameterNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'beta'</span>, <span class="st">'gamma'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                               rcpp <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                               sde <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># simulate a tree based on the model: </span></span></span>
<span class="r-in"><span><span class="va">tre</span> <span class="op">&lt;-</span> <span class="fu">sim.co.tree</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">1.5</span>, gamma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       <span class="va">dm</span>,</span></span>
<span class="r-in"><span>                       x0  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>I <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       t0 <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                       sampleTimes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">15</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       res <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot the tree </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tre</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sim.co.tree-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Website developed by <a href="https://thednainus.wordpress.com/me/" class="external-link">Fabricia F. Nascimento</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

