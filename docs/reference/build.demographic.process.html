<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Build a demographic process model (ODE or SDE) — build.demographic.process • phydynR</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build a demographic process model (ODE or SDE) — build.demographic.process"><meta name="description" content="A model is constructed by supplying birth rates, migration rates, and death rates.
The model can be used to simulate demographic histories or as an input to coalescent
simulation or likelihood calculation.
The demographic model can be created using ordinary differential equations (ODEs)
or stochastic differential equations (SDEs)"><meta property="og:description" content="A model is constructed by supplying birth rates, migration rates, and death rates.
The model can be used to simulate demographic histories or as an input to coalescent
simulation or likelihood calculation.
The demographic model can be created using ordinary differential equations (ODEs)
or stochastic differential equations (SDEs)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phydynR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/phydynR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/sir_model.html">Estimating transmission rate using the SIR model</a></li>
    <li><a class="dropdown-item" href="../articles/HIV_epidemics.html">Estimating HIV transmission rates</a></li>
    <li><a class="dropdown-item" href="../articles/simulate_genealogies.html">Simulating genealogies with an epidemiological coalescent model</a></li>
    <li><a class="dropdown-item" href="../articles/SenegalHIVmodel.html">HIV Senegal Model</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emvolz-phylodynamics/phydynR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Build a demographic process model (ODE or SDE)</h1>
      <small class="dont-index">Source: <a href="https://github.com/emvolz-phylodynamics/phydynR/blob/HEAD/R/treeSimulatorCpp2.R" class="external-link"><code>R/treeSimulatorCpp2.R</code></a></small>
      <div class="d-none name"><code>build.demographic.process.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A model is constructed by supplying birth rates, migration rates, and death rates.
The model can be used to simulate demographic histories or as an input to coalescent
simulation or likelihood calculation.
The demographic model can be created using ordinary differential equations (ODEs)
or stochastic differential equations (SDEs)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">build.demographic.process</span><span class="op">(</span></span>
<span>  <span class="va">births</span>,</span>
<span>  nonDemeDynamics <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  migrations <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  deaths <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  parameterNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rcpp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sde <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-births">births<a class="anchor" aria-label="anchor" href="#arg-births"></a></dt>
<dd><p>A named character vector or matrix of mathematical expressions
that describe model birth rates. Names correspond to each deme. If there is
more than one deme, a matrix must be supplied describing birth rates between
each pair of demes. Either R or C code can be supplied (see rcpp option).</p></dd>


<dt id="arg-nondemedynamics">nonDemeDynamics<a class="anchor" aria-label="anchor" href="#arg-nondemedynamics"></a></dt>
<dd><p>A named character vector of mathematical expressions
that describe rate of change for dynamic variables which are not demes;
for example: an equation for the number susceptible in an SIR model.</p></dd>


<dt id="arg-migrations">migrations<a class="anchor" aria-label="anchor" href="#arg-migrations"></a></dt>
<dd><p>A named character vector or matrix of mathematical expressions
that describe model migration rates. Names correspond to each deme. If there
is more than one deme, a matrix must be supplied describing migration rates
between each pair of demes. Either R or C code can be supplied
(see rcpp option).</p></dd>


<dt id="arg-deaths">deaths<a class="anchor" aria-label="anchor" href="#arg-deaths"></a></dt>
<dd><p>A named character vector of mathematical expressions that
describe death rates in each deme.</p></dd>


<dt id="arg-parameternames">parameterNames<a class="anchor" aria-label="anchor" href="#arg-parameternames"></a></dt>
<dd><p>A character vector providing the names of static
parameters used in the model.</p></dd>


<dt id="arg-rcpp">rcpp<a class="anchor" aria-label="anchor" href="#arg-rcpp"></a></dt>
<dd><p>If TRUE, the expressions are interpreted as C code using the Rcpp
package.</p></dd>


<dt id="arg-sde">sde<a class="anchor" aria-label="anchor" href="#arg-sde"></a></dt>
<dd><p>If TRUE, a stochastic differential equation model is constructed;
if FALSE, an ordinary differential equation model is constructed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>demographic.process</code>, which is a function
  that can be used to simulate the model. The model can also be used as an
  input to tree simulation or likelihood calculation.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Erik Volz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A simple exponential growth model with birth rates beta, and death rates gamma:</span></span></span>
<span class="r-in"><span><span class="co"># I is the number of infected individuals.</span></span></span>
<span class="r-in"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu">build.demographic.process</span><span class="op">(</span>births<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>I <span class="op">=</span> <span class="st">'parms$beta * I'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                deaths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>I <span class="op">=</span> <span class="st">'parms$gamma * I'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                parameterNames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'beta'</span>, <span class="st">'gamma'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                rcpp<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                                sde <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Do a simulation and plot the trajectory:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="show.demographic.process.html">show.demographic.process</a></span><span class="op">(</span><span class="va">dm</span>,</span></span>
<span class="r-in"><span>                         theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">1.5</span>, gamma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         x0  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>I <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         t0 <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                         t1 <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="build.demographic.process-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Website developed by <a href="https://thednainus.wordpress.com/me/" class="external-link">Fabricia F. Nascimento</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

