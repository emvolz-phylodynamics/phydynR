<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimating HIV transmission rates • phydynR</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating HIV transmission rates">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phydynR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/phydynR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/sir_model.html">Estimating transmission rate using the SIR model</a></li>
    <li><a class="dropdown-item" href="../articles/HIV_epidemics.html">Estimating HIV transmission rates</a></li>
    <li><a class="dropdown-item" href="../articles/simulate_genealogies.html">Simulating genealogies with an epidemiological coalescent model</a></li>
    <li><a class="dropdown-item" href="../articles/SenegalHIVmodel.html">HIV Senegal Model</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emvolz-phylodynamics/phydynR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimating HIV transmission rates</h1>
                        <h4 data-toc-skip class="author">Erik Volz</h4>
            
            <h4 data-toc-skip class="date">2024-11-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/emvolz-phylodynamics/phydynR/blob/HEAD/vignettes/HIV_epidemics.Rmd" class="external-link"><code>vignettes/HIV_epidemics.Rmd</code></a></small>
      <div class="d-none name"><code>HIV_epidemics.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette will demonstrate how to use structured coalescent models <span class="citation">(Volz 2012)</span>
to estimate epidemiological parameters given a pathogen genealogy and discrete
trait information about sampled individuals.</p>
</div>
<div class="section level2">
<h2 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h2>
<p>This tutorial assumes you have the following R packages already installed in
your computer.</p>
<ul>
<li>
<a href="https://github.com/emvolz-phylodynamics/phydynR" class="external-link">phydynR</a>: implements the coalescent simulation and likelihood function for phylodynamic analyses.</li>
<li>
<a href="https://github.com/bbolker/bbmle" class="external-link">bbmle</a>: tools for general likelihood estimation.</li>
<li>
<a href="https://ggplot2.tidyverse.org/" class="external-link">ggplot2</a>: functions to plot the demographic
process.</li>
</ul>
<div class="section level3">
<h3 id="load-the-r-packages">Load the R packages<a class="anchor" aria-label="anchor" href="#load-the-r-packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://emvolz-phylodynamics.github.io/phydynR/">phydynR</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbolker/bbmle" class="external-link">bbmle</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-epidemiological-model">The epidemiological model<a class="anchor" aria-label="anchor" href="#the-epidemiological-model"></a>
</h2>
<p>We will focus on the problem of estimating HIV transmission rates by stage of
infection and assuming we know the stage of infection when patients are sampled
and virus is sequenced. We will fit a very simple model of an HIV epidemic using
ordinary differential equations (ODEs).
In this model, the infectious period will be broken into three stages
of different average duration and with different transmission rates. The first
stage, early HIV infection (EHI) is short (average duration <span class="math inline">\(1/\gamma_0 = 1\)</span> year),
but has high transmission rate <span class="math inline">\(\beta_0\)</span>. The second stage, chronic HIV infection,
is long (average duration <span class="math inline">\(1/\gamma_1 = 7\)</span> years), and has small transmission rate.
The last stage, AIDS, lasts <span class="math inline">\(1/\gamma_2 = 2\)</span> years on average and has an intermediate
transmission rate. There are births into the susceptible state at rate <span class="math inline">\(bN\)</span> where
<span class="math inline">\(N = S + I_0 + I_1 + I_2\)</span>. And there is mortality due to natural causes from all states
at rate <span class="math inline">\(\mu\)</span>. The parameter values are listed in table <a href="#tab:table1">1</a>.</p>
<p>The model equations are:</p>
<p><span class="math inline">\(\dot{S} = bN − \mu S − (\beta_0I_0 + \beta_1I_1 + \beta_2I_2)S/N\)</span></p>
<p><span class="math inline">\(\dot{I_0} = (\beta_0I_0 + \beta_1I_1 + \beta_2I_2)S/N − (\mu + \gamma_0)I_0\)</span></p>
<p><span class="math inline">\(\dot{I_1} = \gamma_0I_0 − (\mu + \gamma_1)I_1\)</span></p>
<p><span class="math inline">\(\dot{I_2} = \gamma_1I_1 − (\mu + \gamma_2)I_2\)</span></p>
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:table1">Table 1: </span>Parameter symbols and values
</caption>
<thead><tr>
<th style="text-align:left;">
Parameter
</th>
<th style="text-align:left;">
Symbol
</th>
<th style="text-align:left;">
Values
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Duration EHI
</td>
<td style="text-align:left;">
<span class="math inline">\(1/\gamma_0\)</span>
</td>
<td style="text-align:left;">
1 year
</td>
</tr>
<tr>
<td style="text-align:left;">
Duration chronic
</td>
<td style="text-align:left;">
<span class="math inline">\(1/\gamma_1\)</span>
</td>
<td style="text-align:left;">
7 years
</td>
</tr>
<tr>
<td style="text-align:left;">
Duration AIDS
</td>
<td style="text-align:left;">
<span class="math inline">\(1/\gamma_2\)</span>
</td>
<td style="text-align:left;">
2 years
</td>
</tr>
<tr>
<td style="text-align:left;">
Birth rate
</td>
<td style="text-align:left;">
<span class="math inline">\(b\)</span>
</td>
<td style="text-align:left;">
0.036
</td>
</tr>
<tr>
<td style="text-align:left;">
Natural death rate
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(1/30\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
EHI transmission rate
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta_0\)</span>
</td>
<td style="text-align:left;">
1.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Chronic transmission rate
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:left;">
0.03
</td>
</tr>
<tr>
<td style="text-align:left;">
AIDS transmission rate
</td>
<td style="text-align:left;">
<span class="math inline">\(\beta_2\)</span>
</td>
<td style="text-align:left;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
Initial number of susceptibles
</td>
<td style="text-align:left;">
<span class="math inline">\(S(0)\)</span>
</td>
<td style="text-align:left;">
3000
</td>
</tr>
</tbody>
</table>
<p>Create a list of the true parameter values:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">parms_truth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gamma0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                     gamma1 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">7</span>,</span>
<span>                     gamma2 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>                     mu <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">30</span>,</span>
<span>                     b <span class="op">=</span> <span class="fl">0.036</span>,</span>
<span>                     beta0 <span class="op">=</span> <span class="fl">12.</span><span class="op">/</span><span class="fl">10</span>,</span>
<span>                     beta1 <span class="op">=</span> <span class="fl">3.</span><span class="op">/</span><span class="fl">100</span>,</span>
<span>                     beta2 <span class="op">=</span> <span class="fl">9.</span><span class="op">/</span><span class="fl">100</span>,</span>
<span>                     S_0 <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>                     I0_0 <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                     I1_0 <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span>                     I2_0 <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                     m <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                     mm <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>In order to fit this model, we need to express the equations in a canonical
format. According to this format, we will tally birth and migration events
between demes. In our example, the deme corresponds to the stage of infection
that an infected host can be in, so we will refer the demes with the following
names:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">INFECTEDNAMES</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'I0'</span>, <span class="st">'I1'</span>, <span class="st">'I2'</span><span class="op">)</span></span></code></pre></div>
<p>There are <span class="math inline">\(m = 3\)</span> demes in this model, so the birth events between demes
needs to be expressed with a <span class="math inline">\(3 × 3\)</span> matrix F. The element <span class="math inline">\(F_kl\)</span> represents the
rate of transmissions by a host in deme <span class="math inline">\(k\)</span> to a host in deme <span class="math inline">\(l\)</span>.
In our example, this is the following:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">births</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'parms$beta0 * S * I0 / (S + I0 + I1 + I2)'</span>, <span class="st">'0'</span>, <span class="st">'0'</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'parms$beta1 * S * I1 / (S + I0 + I1 + I2)'</span>, <span class="st">'0'</span>, <span class="st">'0'</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'parms$beta2 * S * I2 / (S + I0 + I1 + I2)'</span>, <span class="st">'0'</span>, <span class="st">'0'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">births</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">births</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">INFECTEDNAMES</span></span></code></pre></div>
<p>Each element of the matrix is a string that will be parsed as R code and evaluated,
so it is important to write it exactly as you would if you were solving
the equations outside of phydynR. Also note that the object parms is accessible
to these equations, which is a list of parameters - this may include parameters
to be estimated. Note that there are zero rates in the 2nd and third columns,
since all new infected hosts start out in the first stage of infection (EHI).
Also note that we must give row and column names to the matrix, and these names
must correspond to the names of the demes.</p>
<p>Similarly, we must create a matrix of migrations:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">migrations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'0'</span>, <span class="st">'parms$gamma0 * I0'</span>, <span class="st">'0'</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'0'</span>, <span class="st">'0'</span>, <span class="st">'parms$gamma1 * I1'</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'0'</span>, <span class="st">'0'</span>, <span class="st">'0'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">migrations</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">migrations</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">INFECTEDNAMES</span></span></code></pre></div>
<p>Note that this matrix tallys the stage progression from EHI to chronic and from
chronic to AIDS.</p>
<p>We must also write a vector of expressions for events that terminate a
lineage – In this model, this occurs due to natural or AIDS related mortality:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">deaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'parms$mu*I0'</span>,</span>
<span>            <span class="st">'parms$mu*I1'</span>,</span>
<span>            <span class="st">'parms$mu*I2 + parms$gamma2 * I2'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">deaths</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">INFECTEDNAMES</span></span></code></pre></div>
<p>Finally, we must write a vector of ODEs for state variables that do not
correspond to demes in the coalescent model. In our example, there is only one
such variable- the number of susceptibles:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nonDemeDynamics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span>sep <span class="op">=</span> <span class="st">''</span>,</span>
<span>                         <span class="st">'-parms$mu*S + parms$mu*(S + I0 + I1 + I2)'</span>,</span>
<span>                         <span class="st">'- S * (parms$beta0*I0+parms$beta1*I1+parms$beta2*I2) / (S + I0 + I1 + I2)'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nonDemeDynamics</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">'S'</span></span></code></pre></div>
<p>Note well that in all cases, the expression or equation must have the
corresponding name of the state variable.
The model can be fitted to a binary tree with dated tips. We will use a
simulated tree such that we know the true parameter values and population size
through time. We load this by:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read the tree</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html" class="external-link">read.tree</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/hivSimulation.nwk'</span>, package<span class="op">=</span><span class="st">'phydynR'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the sample times are the same, because it is a homochronous sample at 50 years</span></span>
<span><span class="va">sampleTimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sampleTimes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span></span>
<span></span>
<span><span class="co"># create a tree with dated tips and internal nodes,</span></span>
<span><span class="co"># will infer the sample states from tip labels</span></span>
<span><span class="va">bdt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/DatedTree.html">DatedTree</a></span><span class="op">(</span>phylo <span class="op">=</span> <span class="va">tree</span>, </span>
<span>                 sampleTimes <span class="op">=</span> <span class="va">sampleTimes</span>,</span>
<span>                 minEdgeLength <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">bdt</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Phylogenetic tree with 318 tips and 317 internal nodes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tip labels:</span></span>
<span><span class="co">#&gt;   89_I1, 349_I2, 339_I1, 64_I1, 203_I1, 30_I0, ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rooted; includes branch lengths.</span></span></code></pre></div>
<p>Note well that the vector of sample times must have the names of each taxon.
If the state of each taxon (the stage of infection of each sample unit) is encoded
at the end of taxon name, it can be loaded automatically by passing the argument
<em>sampleStatesAnnotations</em>. Alternatively, that information can be passed as a
matrix with row names corresponding to the tip labels of the tree.</p>
<p>After setting up all the components of the mathematical model, we can build the
demographic process using the function <code>build.demographic.process</code> from the <code>phydynR</code>
package. The <code>dm</code> output can be used as input to coalescent models for the
calculation of the likelihood.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build.demographic.process.html">build.demographic.process</a></span><span class="op">(</span>births <span class="op">=</span> <span class="va">births</span>,</span>
<span>                                nonDemeDynamics <span class="op">=</span> <span class="va">nonDemeDynamics</span>,</span>
<span>                                migrations <span class="op">=</span> <span class="va">migrations</span>,</span>
<span>                                deaths <span class="op">=</span> <span class="va">deaths</span>,</span>
<span>                                parameterNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">parms_truth</span><span class="op">)</span>,</span>
<span>                                rcpp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                sde <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Now we can calculate the likelihood of the tree and see how long it takes
by using the <code>system.time</code> function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/colik.html">colik</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">bdt</span>,</span>
<span>        theta <span class="op">=</span> <span class="va">parms_truth</span>,</span>
<span>        demographic.process.model <span class="op">=</span> <span class="va">dm</span>,</span>
<span>        x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>I0 <span class="op">=</span> <span class="fl">1</span>, I1 <span class="op">=</span> <span class="fl">0.01</span>, I2 <span class="op">=</span> <span class="fl">0.01</span>, S <span class="op">=</span> <span class="va">parms_truth</span><span class="op">$</span><span class="va">S_0</span><span class="op">)</span>,</span>
<span>        t0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        res <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>        integrationMethod <span class="op">=</span> <span class="st">'euler'</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>It is a bit slow, so note that there is an alternative low-level interface that
can be a bit faster (<code>colik.pik.fgy</code>). Also note that changing
the <em>integrationMethod</em> (choose ‘euler’), <em>maxHeight</em> (only fit to part of
the tree) and <em>res</em> (set to a smaller value) options can dramatically
speed up the calculation at the cost of some accuracy.
We can fit the model by using the <code>bbmle</code> or <code>stats4</code> package.</p>
</div>
<div class="section level2">
<h2 id="fitting-the-model">Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model"></a>
</h2>
<p>We will focus on estimating the three transmission rates of the system along with
a nuisance parameter that controls initial conditions, <span class="math inline">\(t_0\)</span>, which is the time of
origin of the epidemic. We will assume prior knowledge of the stage progression
rates <span class="math inline">\(\gamma_i\)</span> mortality rates <span class="math inline">\(\mu\)</span>, and susceptible population size <span class="math inline">\(S(0)\)</span>.</p>
<p>First, create the objective function to be minimized:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lnbeta0</span>, <span class="va">lnbeta1</span>, <span class="va">lnbeta2</span>, <span class="va">t0</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">parms</span> <span class="op">&lt;-</span> <span class="va">parms_truth</span></span>
<span>  <span class="va">parms</span><span class="op">$</span><span class="va">beta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lnbeta0</span><span class="op">)</span></span>
<span>  <span class="va">parms</span><span class="op">$</span><span class="va">beta1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lnbeta1</span><span class="op">)</span></span>
<span>  <span class="va">parms</span><span class="op">$</span><span class="va">beta2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lnbeta2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">mll</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="../reference/colik.html">colik</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="va">bdt</span>,</span>
<span>                theta <span class="op">=</span> <span class="va">parms</span>,</span>
<span>                demographic.process.model <span class="op">=</span> <span class="va">dm</span>,</span>
<span>                x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>I0 <span class="op">=</span> <span class="fl">1</span>, I1 <span class="op">=</span> <span class="fl">0.01</span>, I2 <span class="op">=</span> <span class="fl">0.01</span>, S <span class="op">=</span> <span class="va">parms_truth</span><span class="op">$</span><span class="va">S_0</span><span class="op">)</span>,</span>
<span>                t0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                res <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                integrationMethod <span class="op">=</span> <span class="st">'rk4'</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># track progress:</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mll</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">lnbeta0</span>, <span class="va">lnbeta1</span>, <span class="va">lnbeta2</span><span class="op">)</span> <span class="op">)</span>, <span class="va">t0</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">mll</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Note that this uses log-transformation for variables that must be positive (like
rates).</p>
<p>We can then fit the model by running</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/bbmle/man/mle2.html" class="external-link">mle2</a></span><span class="op">(</span><span class="va">obj_fun</span>,</span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lnbeta0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span>, </span>
<span>                         lnbeta1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>, </span>
<span>                         lnbeta2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span>, </span>
<span>                         t0 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>            method<span class="op">=</span><span class="st">'Nelder-Mead'</span>, </span>
<span>            optimizer<span class="op">=</span><span class="st">'optim'</span>,</span>
<span>            control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="fl">6</span>, reltol <span class="op">=</span> <span class="fl">1e-8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that we are starting the optimizer far from the true parameter values. If
fitting a model to real data, it is recommended to try many different starting
conditions over a large range of values. The optimizer would take about 10
minutes to run, so instead we will load the results:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/hivModel0-fit.RData'</span>, package<span class="op">=</span><span class="st">'phydynR'</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4447.468</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'log Lik.' -2219.734 (df=4)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt;    lnbeta0    lnbeta1    lnbeta2         t0 </span></span>
<span><span class="co">#&gt;  0.1772788 -3.3862403 -2.9639203 -1.8339507</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    lnbeta0    lnbeta1    lnbeta2         t0 </span></span>
<span><span class="co">#&gt; 1.19396395 0.03383565 0.05161617 0.15978107</span></span></code></pre></div>
<p>We can compare the fitted model to the true number of infected through
time, which is shown in Figure <a href="#fig:figure1">1</a></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parms</span> <span class="op">&lt;-</span> <span class="va">parms_truth</span></span>
<span><span class="va">parms</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'beta0'</span>, <span class="st">'beta1'</span>, <span class="st">'beta2'</span>, <span class="st">'t0'</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">parms</span><span class="op">$</span><span class="va">t0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">parms</span><span class="op">$</span><span class="va">t0</span><span class="op">)</span></span>
<span><span class="va">ox</span> <span class="op">&lt;-</span> <span class="fu">dm</span><span class="op">(</span>theta <span class="op">=</span> <span class="va">parms</span>, </span>
<span>         x0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>I0 <span class="op">=</span> <span class="fl">1</span>, I1 <span class="op">=</span><span class="fl">0.01</span>, I2 <span class="op">=</span> <span class="fl">0.01</span>, S <span class="op">=</span> <span class="va">parms_truth</span><span class="op">$</span><span class="va">S_0</span><span class="op">)</span>, </span>
<span>         t0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">[</span><span class="st">'t0'</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         t1 <span class="op">=</span> <span class="va">bdt</span><span class="op">$</span><span class="va">maxSampleTime</span>, </span>
<span>         res <span class="op">=</span> <span class="fl">1e3</span>, </span>
<span>         integrationMethod<span class="op">=</span><span class="st">'rk4'</span><span class="op">)</span></span>
<span><span class="va">o</span> <span class="op">&lt;-</span> <span class="va">ox</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> </span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="va">o</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">real_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">rtimes</span>, <span class="va">rY</span><span class="op">)</span></span>
<span><span class="va">rdata</span> <span class="op">&lt;-</span> <span class="fu">gather</span><span class="op">(</span><span class="va">real_data</span>, <span class="st">"Demes"</span>, <span class="st">"I"</span>, <span class="va">I0</span><span class="op">:</span><span class="va">I2</span>, factor_key<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rdata</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rtimes</span>, y <span class="op">=</span> <span class="va">I</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">Demes</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"green"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">o</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">I0</span><span class="op">)</span>, col<span class="op">=</span><span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">o</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">I1</span><span class="op">)</span>, col<span class="op">=</span><span class="st">'red'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">o</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">I2</span><span class="op">)</span>, col<span class="op">=</span><span class="st">'green'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Number of infected by stage"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:figure1"></span>
<img src="HIV_epidemics_files/figure-html/figure1-1.png" alt="The actual (points) and estimated (lines) number of infections through time. Black: EHI, Red: chronic, Green: AIDS"><p class="caption">
Figure 1: The actual (points) and estimated (lines) number of infections through time. Black: EHI, Red: chronic, Green: AIDS
</p>
</div>
<p>We can calculate a confidence interval for the transmission rates using likelihood
profiles:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">profbeta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/profile.html" class="external-link">profile</a></span><span class="op">(</span><span class="va">fit</span>, </span>
<span>                    which <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>, </span>
<span>                    std.err <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                    trace <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                    tol.newmin <span class="op">=</span> <span class="fl">1</span> <span class="op">)</span></span></code></pre></div>
<p>This takes a long time, so we will load the results:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/hivModel0-profbeta.RData'</span>, package<span class="op">=</span><span class="st">'phydynR'</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p>We see that the confidence interval covers the true value:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">profbeta</span> <span class="op">)</span><span class="op">)</span>, TrueVal <span class="op">=</span> <span class="va">parms_truth</span><span class="op">$</span><span class="va">beta0</span><span class="op">)</span></span>
<span><span class="co">#&gt;    2.5 %   97.5 %  TrueVal </span></span>
<span><span class="co">#&gt; 1.093873 1.243095 1.200000</span></span></code></pre></div>
<p>And, we can visualize the profile (Figure <a href="#fig:figure2">2</a>).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#fig.asp sets the height-to-width ratio of the figure</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">profbeta</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span> v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span> <span class="va">parms_truth</span><span class="op">$</span><span class="va">beta0</span><span class="op">)</span> , col<span class="op">=</span><span class="st">'red'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:figure2"></span>
<img src="HIV_epidemics_files/figure-html/figure2-1.png" alt="Likelihood profile for the transmission rate $\beta_0$ with confidence levels. The true parameter value is indicated by the vertical red line."><p class="caption">
Figure 2: Likelihood profile for the transmission rate <span class="math inline">\(\beta_0\)</span> with confidence levels. The true parameter value is indicated by the vertical red line.
</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Volz2012" class="csl-entry">
Volz, Erik M. 2012. <span>“<span class="nocase">Complex Population Dynamics and the Coalescent Under Neutrality</span>.”</span> <em>Genetics</em> 190 (1): 187–201. <a href="https://doi.org/10.1534/genetics.111.134627" class="external-link">https://doi.org/10.1534/genetics.111.134627</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Website developed by <a href="https://thednainus.wordpress.com/me/" class="external-link">Fabricia F. Nascimento</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
